# Analyze-ab-test-results

# 分析A/B测试结果

## 背景

通常情况下，A/B 测试由数据分析师和数据科学家来完成。本项目将要了解的是电子商务网站运行的 A/B 测试的结果。


## 目的

通过这个 notebook 来帮助公司弄清楚他们是否应该使用新的页面，保留旧的页面，或者应该将测试时间延长，之后再做出决定。

## 分析

### 假设集：

零假设（*H<sub>0*）: *p<sub>old* >=*p<sub>new*

对立假设（*H<sub>1*）:*p<sub>old* <*p<sub>new* 

假定在零假设中，不管是新页面还是旧页面， *p<sub>new* and *p<sub>old* 都具有等于 **转化** 成功率的“真”成功率，也就是说， *p<sub>new* 与 *p<sub>old*是相等的。此外，假设它们都等于**ab_data.csv** 中的 **转化** 率，新旧页面都是如此。每个页面的样本大小要与 **ab_data.csv** 中的页面大小相同。 执行两次页面之间 **转化** 差异的抽样分布，计算零假设中10000次迭代计算的估计值。

### 方法1：

a. 在零假设中，计算*p<sub>new* 的 **convert rate（转化率）**；

b. 在零假设中， 计算*p<sub>old*  的 **convert rate（转化率）** ；

c. 计算*n<sub>new*；

d. 计算*n<sub>old* ；

e. 在零假设中，使用*p<sub>new* 转化率模拟 *n<sub>new*交易，并将这些*n<sub>new* 1's 与 0's 存储在 **new_page_converted** 中；

f. 在零假设中，使用 *p<sub>old*  转化率模拟 *n<sub>old*交易，并将这些 *n<sub>old*1's 与 0's 存储在 **old_page_converted** 中；

g. 在 (e) 与 (f)中找到 *p<sub>new* - *p<sub>old*  模拟值；

h. 使用**a. 到 g.** 中的计算方法来模拟 10,000个*p<sub>new* - *p<sub>old* 值，并将这 10,000 个值存储在 **p_diffs**中；

i. 绘制一个 **p_diffs** 直方图；

![p_diffs直方图](https://github.com/ArtemisLiu/Analyze-ab-test-results/blob/master/结论图表/p_diffs直方图.png)

直方图与我期望的一样，样本量足够大，呈正态分布，均值为0。

j. 在**p_diffs**列表的数值中，有多大比例大于 **ab_data.csv** 中观察到的实际差值；

计算P值得0.91。

![比例](https://github.com/ArtemisLiu/Analyze-ab-test-results/blob/master/结论图表/比例.png)

在科学研究中，这个值为P值。P值代表，如果零假设为真，那么观察到支持备择假设的极端值的概率。我们计算得P值为0.91，大于0.05，所以不应该抛弃零假设。

### 方法2：

我们也可以使用一个内置程序 （built-in）来实现类似的结果。尽管使用内置程序可能更易于编写代码，但上面的内容是对正确思考统计显著性至关重要的思想的一个预排。

计算每个页面的转化次数，以及每个页面的访问人数。使用*n<sub>old*与*n<sub>new* 分别引证与旧页面和新页面关联的行数。

使用 `stats.proportions_ztest` 来计算检验统计量与 p值结果如下：

```
(1.3109241984234394, 0.9050583127590245)
```

p值为0.905，大于0.05，因此不能拒绝原假设。Z-test与j和k得出结果一致，都是不能拒绝原假设，P值的大小（0.905 和 0.91）也非常相似。

### 方法3：回归分析

之前的A / B测试中获得的结果也可以通过执行回归来获取。

a. 既然每行的值是转化或不转化，那么在这种情况下，我们应该执行**逻辑回归**;

b. 目标是使用 **statsmodels** 来拟合在 **a.** 中指定的回归模型，以查看用户收到的不同页面是否存在显著的转化差异。但是，首先需要为这个截距创建一个列 ，并为每个用户收到的页面创建一个虚拟变量列。添加一个 **截距** 列，一个 **ab_page** 列，当用户接收 **treatment** 时为1， **control** 时为0;

c. 使用 **statsmodels** 导入回归模型。 实例化该模型，并使用在 **b.** 中创建的2个列来拟合该模型，用来预测一个用户是否会发生转化;

d. 模型摘要;

![模型摘要](https://github.com/ArtemisLiu/Analyze-ab-test-results/blob/master/结论图表/模型摘要.png)

e. 与 **ab_page** 关联的 p值是0.19，这表明我们不能证明ab_page具有统计显著性。在回归模型中，零假设是新旧页面不存在显著的转化差异，备择假设是新旧页面存在显著的转化差异，而在前面的方法中，零假设是旧页面转化率大于等于新页面转化率，备择假设是新页面转化率大于旧页面转化率，类型I错误率为5％。

## 结论

以上三种方法均表明我们不能抛弃零假设。